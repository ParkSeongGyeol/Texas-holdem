# ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨ (State Diagram)

**ì‘ì„±ì**: ë°•ì„±ê²°
**ì‘ì„±ì¼**: 2025-10-01
**ëª©ì **: ê²Œì„ ì§„í–‰ ë¡œì§ì˜ ìƒíƒœ ê´€ë¦¬ (FSM) ì„¤ê³„

---

## ğŸ“š ëª©ì°¨
1. [ê²Œì„ í˜ì´ì¦ˆ FSM](#ê²Œì„-í˜ì´ì¦ˆ-fsm)
2. [í”Œë ˆì´ì–´ ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨](#í”Œë ˆì´ì–´-ìƒíƒœ-ë‹¤ì´ì–´ê·¸ë¨)
3. [ë² íŒ… ë¼ìš´ë“œ ìƒíƒœ íë¦„](#ë² íŒ…-ë¼ìš´ë“œ-ìƒíƒœ-íë¦„)
4. [êµ¬í˜„ ê°€ì´ë“œ](#êµ¬í˜„-ê°€ì´ë“œ)

---

## ê²Œì„ í˜ì´ì¦ˆ FSM

### ìƒíƒœ ì •ì˜

```python
class GamePhase(Enum):
    """ê²Œì„ ë‹¨ê³„"""
    PREFLOP = "preflop"    # í™€ ì¹´ë“œ ë°°ë¶„ í›„
    FLOP = "flop"          # ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 3ì¥ ê³µê°œ í›„
    TURN = "turn"          # ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 4ì¥ (1ì¥ ì¶”ê°€)
    RIVER = "river"        # ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 5ì¥ (1ì¥ ì¶”ê°€)
    SHOWDOWN = "showdown"  # ìŠ¹ì ê²°ì •
```

### ìƒíƒœ ì „ì´ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ê²Œì„ ì‹œì‘ (new_hand)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  PREFLOP    â”‚
                    â”‚  (ì´ˆê¸° ìƒíƒœ) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ í™€ ì¹´ë“œ 2ì¥ ë°°ë¶„
                           â”‚ ë¸”ë¼ì¸ë“œ ë² íŒ…
                           â”‚ ë² íŒ… ë¼ìš´ë“œ 1
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    FLOP     â”‚
                    â”‚ (ì»¤ë®¤ë‹ˆí‹° 3) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ ë²ˆ ì¹´ë“œ + ì¹´ë“œ 3ì¥ ê³µê°œ
                           â”‚ ë² íŒ… ë¼ìš´ë“œ 2
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    TURN     â”‚
                    â”‚ (ì»¤ë®¤ë‹ˆí‹° 4) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ ë²ˆ ì¹´ë“œ + ì¹´ë“œ 1ì¥ ê³µê°œ
                           â”‚ ë² íŒ… ë¼ìš´ë“œ 3
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   RIVER     â”‚
                    â”‚ (ì»¤ë®¤ë‹ˆí‹° 5) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ ë²ˆ ì¹´ë“œ + ì¹´ë“œ 1ì¥ ê³µê°œ
                           â”‚ ë² íŒ… ë¼ìš´ë“œ 4 (ë§ˆì§€ë§‰)
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SHOWDOWN   â”‚
                    â”‚  (ìŠ¹ì ê²°ì •) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ íŒ¨ ë¹„êµ ë° íŒŸ ë¶„ë°°
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  í•¸ë“œ ì¢…ë£Œ   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“ (ë‹¤ìŒ í•¸ë“œ ì‹œì‘)
                    (ë”œëŸ¬ ë²„íŠ¼ ì´ë™ â†’ PREFLOP)
```

### ì „ì´ ì¡°ê±´

#### PREFLOP â†’ FLOP
- **ì¡°ê±´**:
  - ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ (ëª¨ë“  í”Œë ˆì´ì–´ ë² íŒ…ì•¡ ì¼ì¹˜)
  - 2ëª… ì´ìƒì˜ í”Œë ˆì´ì–´ê°€ ì•¡í‹°ë¸Œ ìƒíƒœ
- **ì•¡ì…˜**:
  - `deal_flop()` í˜¸ì¶œ
  - ë²ˆ ì¹´ë“œ 1ì¥ ë²„ë¦¼
  - ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 3ì¥ ê³µê°œ
  - `current_phase = GamePhase.FLOP`

#### FLOP â†’ TURN
- **ì¡°ê±´**:
  - ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ
  - 2ëª… ì´ìƒì˜ í”Œë ˆì´ì–´ê°€ ì•¡í‹°ë¸Œ ìƒíƒœ
- **ì•¡ì…˜**:
  - `deal_turn()` í˜¸ì¶œ
  - ë²ˆ ì¹´ë“œ 1ì¥ ë²„ë¦¼
  - ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 1ì¥ ì¶”ê°€ ê³µê°œ
  - `current_phase = GamePhase.TURN`

#### TURN â†’ RIVER
- **ì¡°ê±´**:
  - ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ
  - 2ëª… ì´ìƒì˜ í”Œë ˆì´ì–´ê°€ ì•¡í‹°ë¸Œ ìƒíƒœ
- **ì•¡ì…˜**:
  - `deal_river()` í˜¸ì¶œ
  - ë²ˆ ì¹´ë“œ 1ì¥ ë²„ë¦¼
  - ì»¤ë®¤ë‹ˆí‹° ì¹´ë“œ 1ì¥ ì¶”ê°€ ê³µê°œ
  - `current_phase = GamePhase.RIVER`

#### RIVER â†’ SHOWDOWN
- **ì¡°ê±´**:
  - ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ
  - 2ëª… ì´ìƒì˜ í”Œë ˆì´ì–´ê°€ ì•¡í‹°ë¸Œ ìƒíƒœ
- **ì•¡ì…˜**:
  - `current_phase = GamePhase.SHOWDOWN`
  - íŒ¨ ë¹„êµ ë° ìŠ¹ì ê²°ì •

#### ì¡°ê¸° ì¢…ë£Œ (Early Exit)
- **ì¡°ê±´**: ì–´ëŠ ë‹¨ê³„ì—ì„œë“  1ëª…ë§Œ ë‚¨ê³  ëª¨ë‘ í´ë“œ
- **ì•¡ì…˜**:
  - ì¦‰ì‹œ ê²Œì„ ì¢…ë£Œ
  - ë‚¨ì€ í”Œë ˆì´ì–´ê°€ íŒŸ íšë“
  - SHOWDOWN ë‹¨ê³„ ìƒëµ

---

## í”Œë ˆì´ì–´ ìƒíƒœ ë‹¤ì´ì–´ê·¸ë¨

### ìƒíƒœ ì •ì˜

```python
class PlayerState:
    is_active: bool      # ê²Œì„ ì°¸ì—¬ ê°€ëŠ¥ ì—¬ë¶€
    has_folded: bool     # í´ë“œ ì—¬ë¶€
    is_all_in: bool      # ì˜¬ì¸ ì—¬ë¶€
    chips: int           # ë³´ìœ  ì¹©
```

### ìƒíƒœ ì „ì´ ë‹¤ì´ì–´ê·¸ë¨

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         ê²Œì„ ì‹œì‘  â”‚   ACTIVE    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ is_active=T â”‚â—€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚ folded=F    â”‚       â”‚
         â”‚          â”‚ all_in=F    â”‚       â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
         â”‚                 â”‚              â”‚
         â”‚                 â”‚              â”‚
         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”      â”‚
         â”‚         â”‚       â”‚       â”‚      â”‚
         â”‚         â”‚       â”‚       â”‚      â”‚ ìƒˆ í•¸ë“œ ì‹œì‘
         â”‚    Fold â”‚  Bet  â”‚ All-inâ”‚      â”‚ (reset)
         â”‚         â”‚       â”‚       â”‚      â”‚
         â”‚         â†“       â†“       â†“      â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
         â”‚   â”‚ FOLDED  â”‚   â”‚  â”‚ ALL-IN  â”‚â”‚
         â”‚   â”‚folded=T â”‚   â”‚  â”‚all_in=T â”‚â”‚
         â”‚   â”‚active=F â”‚   â”‚  â”‚active=T* â”‚â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚
         â”‚         â”‚       â”‚       â”‚     â”‚
         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
         â”‚                 â”‚             â”‚
         â”‚                 â†“             â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
         â”‚          â”‚ í•¸ë“œ ì¢…ë£Œ    â”‚      â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚
         â”‚                 â”‚             â”‚
         â”‚                 â†“             â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
         â”‚     ì¹©>0?â”‚ ìƒíƒœ ë¦¬ì…‹    â”‚      â”‚
         â””â”€â”€â”€â”€â”€â”€YESâ”€â”¤ reset_for_  â”œâ”€â”€â”€â”€â”€â”€â”˜
                    â”‚ new_hand()  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ NO (ì¹©=0)
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚OUT_OF_CHIPS â”‚
                    â”‚ is_active=F â”‚
                    â”‚ chips=0     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        (ê²Œì„ ì œì™¸)
```

### ìƒíƒœë³„ í—ˆìš© ì•¡ì…˜

| ìƒíƒœ | Fold | Check | Call | Raise | All-in |
|------|------|-------|------|-------|--------|
| **ACTIVE** | âœ… | âœ…* | âœ… | âœ… | âœ… |
| **FOLDED** | âŒ | âŒ | âŒ | âŒ | âŒ |
| **ALL-IN** | âŒ | âœ…(ìë™) | âŒ | âŒ | âŒ |
| **OUT_OF_CHIPS** | âŒ | âŒ | âŒ | âŒ | âŒ |

\* CheckëŠ” `current_bet == 0` ì¼ ë•Œë§Œ ê°€ëŠ¥

### ìƒíƒœ ì „ì´ ì¡°ê±´

#### ACTIVE â†’ FOLDED
```python
player.fold()
# íš¨ê³¼:
# - has_folded = True
# - is_active = False
# - í•´ë‹¹ í•¸ë“œì—ì„œ ì œì™¸
```

#### ACTIVE â†’ ALL-IN
```python
player.bet(player.chips)  # ëª¨ë“  ì¹© ë² íŒ…
# íš¨ê³¼:
# - is_all_in = True
# - chips = 0
# - is_active = True (ì—¬ì „íˆ ê²Œì„ ì°¸ì—¬)
# - ì´í›„ ë² íŒ… ë¼ìš´ë“œì—ì„œ ìë™ ì²´í¬
```

#### ACTIVE â†’ ACTIVE (ë² íŒ…)
```python
player.bet(amount)  # amount < player.chips
# íš¨ê³¼:
# - chips -= amount
# - current_bet += amount
# - ì—¬ì „íˆ ACTIVE ìƒíƒœ ìœ ì§€
```

#### í•¸ë“œ ì¢…ë£Œ â†’ ìƒíƒœ ë¦¬ì…‹
```python
if player.chips > 0:
    player.reset_for_new_hand()
    # ë‹¤ìŒ í•¸ë“œì—ì„œ ACTIVE ìƒíƒœë¡œ ë³µê·€
else:
    player.is_active = False
    # OUT_OF_CHIPS ìƒíƒœ (ê²Œì„ ì œì™¸)
```

---

## ë² íŒ… ë¼ìš´ë“œ ìƒíƒœ íë¦„

### ë² íŒ… ë¼ìš´ë“œ FSM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ë² íŒ… ë¼ìš´ë“œ ì‹œì‘                        â”‚
â”‚         (ë¸”ë¼ì¸ë“œ ë˜ëŠ” ë² íŒ… ì—†ìŒ)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ WAITING     â”‚ â† í˜„ì¬ í”Œë ˆì´ì–´ ëŒ€ê¸°
            â”‚ FOR ACTION  â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
   í”Œë ˆì´ì–´ ì•¡ì…˜            íƒ€ì„ì•„ì›ƒ?
        â”‚                     â”‚
        â†“                     â†“ (ìë™ í´ë“œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACTION RECEIVED   â”‚   â”‚ AUTO FOLD   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ UPDATE      â”‚
            â”‚ GAME STATE  â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€ íŒŸì— ë² íŒ… ì¶”ê°€
                   â”œâ”€ current_bet ê°±ì‹ 
                   â””â”€ ë‹¤ìŒ í”Œë ˆì´ì–´ë¡œ ì´ë™
                   â”‚
                   â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ CHECK       â”‚  ì¢…ë£Œ ì¡°ê±´ í™•ì¸
            â”‚ TERMINATION â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚
    ì¢…ë£Œ ì¡°ê±´ ì¶©ì¡±?      ê³„ì† ì§„í–‰
         â”‚                   â”‚
         â†“                   â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ROUND ENDED â”‚   â”‚ NEXT PLAYER â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚
         â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                           â”‚
         â†“                           â†“
  (ë‹¤ìŒ ê²Œì„ í˜ì´ì¦ˆ)         (WAITING FOR ACTION)
```

### ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ ì¡°ê±´

#### ì¡°ê±´ 1: 1ëª…ë§Œ ë‚¨ìŒ (ì¡°ê¸° ì¢…ë£Œ)
```python
active_players = [p for p in players if not p.has_folded]
if len(active_players) == 1:
    return True  # ì¦‰ì‹œ ì¢…ë£Œ, ë‚¨ì€ í”Œë ˆì´ì–´ ìŠ¹ë¦¬
```

#### ì¡°ê±´ 2: ëª¨ë“  í”Œë ˆì´ì–´ ë² íŒ…ì•¡ ì¼ì¹˜
```python
# ì˜¬ì¸í•œ í”Œë ˆì´ì–´ ì œì™¸í•˜ê³  ë² íŒ…ì•¡ í™•ì¸
active_non_allin = [p for p in players
                    if not p.has_folded and not p.is_all_in]

if all(p.current_bet == current_bet for p in active_non_allin):
    # ëª¨ë“  í”Œë ˆì´ì–´ê°€ ìµœì†Œ 1ë²ˆ ì•¡ì…˜í–ˆëŠ”ì§€ í™•ì¸
    if all_players_acted:
        return True  # ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ
```

#### ì¡°ê±´ 3: ëª¨ë‘ ì˜¬ì¸
```python
# í´ë“œí•˜ì§€ ì•Šì€ í”Œë ˆì´ì–´ ì¤‘ ì˜¬ì¸í•˜ì§€ ì•Šì€ ì‚¬ëŒì´ 1ëª… ì´í•˜
non_folded = [p for p in players if not p.has_folded]
non_allin = [p for p in non_folded if not p.is_all_in]

if len(non_allin) <= 1:
    return True  # ë” ì´ìƒ ë² íŒ… ë¶ˆê°€, ë‚¨ì€ ì¹´ë“œ ëª¨ë‘ ê³µê°œ
```

### ë² íŒ… ìˆœì„œ

#### í”„ë¦¬í”Œë¡­ (PREFLOP)
```
2ì¸ ê²Œì„:
1. ë”œëŸ¬/ìŠ¤ëª° ë¸”ë¼ì¸ë“œ ë¨¼ì € ì•¡ì…˜
2. ë¹… ë¸”ë¼ì¸ë“œ ì•¡ì…˜
3. ë”œëŸ¬ â†’ ë¹… ë¸”ë¼ì¸ë“œ ìˆœì„œë¡œ ë°˜ë³µ
```

#### í”Œë¡­/í„´/ë¦¬ë²„ (FLOP/TURN/RIVER)
```
2ì¸ ê²Œì„:
1. ë¹… ë¸”ë¼ì¸ë“œ(ë…¼-ë”œëŸ¬) ë¨¼ì € ì•¡ì…˜
2. ë”œëŸ¬ ì•¡ì…˜
3. ë¹… ë¸”ë¼ì¸ë“œ â†’ ë”œëŸ¬ ìˆœì„œë¡œ ë°˜ë³µ
```

### ë² íŒ… ë¼ìš´ë“œ ì˜ì‚¬ì½”ë“œ

```python
def betting_round(game, starting_player_index):
    current_player_idx = starting_player_index
    last_raiser = None
    all_players_acted = False

    while not is_round_over(game):
        player = game.players[current_player_idx]

        # ìŠ¤í‚µ ì¡°ê±´
        if player.has_folded or player.is_all_in:
            current_player_idx = next_player(current_player_idx)
            continue

        # ì•¡ì…˜ ë°›ê¸°
        action, amount = get_player_action(player, game)

        # ì•¡ì…˜ ì²˜ë¦¬
        if action == Action.FOLD:
            player.fold()
        elif action == Action.CHECK:
            pass  # ì•„ë¬´ ê²ƒë„ ì•ˆ í•¨
        elif action == Action.CALL:
            call_amount = game.current_bet - player.current_bet
            player.bet(call_amount)
            game.pot += call_amount
        elif action == Action.RAISE:
            raise_amount = amount - player.current_bet
            player.bet(raise_amount)
            game.pot += raise_amount
            game.current_bet = player.current_bet
            last_raiser = current_player_idx
        elif action == Action.ALL_IN:
            all_in_amount = player.chips
            player.bet(all_in_amount)
            game.pot += all_in_amount
            if player.current_bet > game.current_bet:
                game.current_bet = player.current_bet
                last_raiser = current_player_idx

        # ë‹¤ìŒ í”Œë ˆì´ì–´
        current_player_idx = next_player(current_player_idx)

        # í•œ ë°”í€´ ëŒì•˜ëŠ”ì§€ í™•ì¸
        if current_player_idx == starting_player_index:
            all_players_acted = True

    # ë¼ìš´ë“œ ì¢…ë£Œ í›„ ë² íŒ… ë¦¬ì…‹
    for player in game.players:
        player.current_bet = 0
    game.current_bet = 0
```

---

## êµ¬í˜„ ê°€ì´ë“œ

### 1. ê²Œì„ í˜ì´ì¦ˆ ê´€ë¦¬

#### game.py êµ¬í˜„
```python
class PokerGame:
    def __init__(self):
        self.current_phase = GamePhase.PREFLOP
        # ...

    def advance_phase(self):
        """ë‹¤ìŒ ê²Œì„ ë‹¨ê³„ë¡œ ì´ë™"""
        if self.current_phase == GamePhase.PREFLOP:
            self.deal_flop()
            self.current_phase = GamePhase.FLOP
        elif self.current_phase == GamePhase.FLOP:
            self.deal_turn()
            self.current_phase = GamePhase.TURN
        elif self.current_phase == GamePhase.TURN:
            self.deal_river()
            self.current_phase = GamePhase.RIVER
        elif self.current_phase == GamePhase.RIVER:
            self.current_phase = GamePhase.SHOWDOWN
            self.showdown()

    def is_hand_over(self) -> bool:
        """í•¸ë“œ ì¢…ë£Œ í™•ì¸"""
        active_count = sum(1 for p in self.players if not p.has_folded)
        return active_count <= 1
```

### 2. í”Œë ˆì´ì–´ ìƒíƒœ ê´€ë¦¬

#### player.py êµ¬í˜„
```python
class Player:
    def get_state(self) -> str:
        """í˜„ì¬ ìƒíƒœ ë¬¸ìì—´ ë°˜í™˜"""
        if not self.is_active:
            if self.chips == 0:
                return "OUT_OF_CHIPS"
            return "INACTIVE"
        if self.has_folded:
            return "FOLDED"
        if self.is_all_in:
            return "ALL_IN"
        return "ACTIVE"

    def can_act(self) -> bool:
        """ì•¡ì…˜ ê°€ëŠ¥ ì—¬ë¶€"""
        return self.is_active and not self.has_folded and not self.is_all_in
```

### 3. ë² íŒ… ë¼ìš´ë“œ ê´€ë¦¬

#### game.pyì— ì¶”ê°€
```python
def run_betting_round(self, starting_position: int):
    """ë² íŒ… ë¼ìš´ë“œ ì‹¤í–‰"""
    current_idx = starting_position
    players_acted = {i: False for i in range(len(self.players))}

    while True:
        player = self.players[current_idx]

        # ì•¡ì…˜ ê°€ëŠ¥í•œ í”Œë ˆì´ì–´ë§Œ
        if player.can_act():
            action, amount = self.get_action(player)
            self.process_action(player, action, amount)
            players_acted[current_idx] = True

        # ì¢…ë£Œ ì¡°ê±´ í™•ì¸
        if self.is_betting_round_over(players_acted):
            break

        # ë‹¤ìŒ í”Œë ˆì´ì–´
        current_idx = (current_idx + 1) % len(self.players)

    # ë¼ìš´ë“œ ì¢…ë£Œ ì •ë¦¬
    for player in self.players:
        player.current_bet = 0
    self.current_bet = 0

def is_betting_round_over(self, players_acted: dict) -> bool:
    """ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ í™•ì¸"""
    # 1ëª…ë§Œ ë‚¨ìŒ
    active = [p for p in self.players if not p.has_folded]
    if len(active) == 1:
        return True

    # ëª¨ë“  í™œì„± í”Œë ˆì´ì–´ê°€ ì•¡ì…˜í–ˆê³  ë² íŒ…ì•¡ ì¼ì¹˜
    for i, player in enumerate(self.players):
        if player.can_act() and not players_acted[i]:
            return False
        if not player.has_folded and not player.is_all_in:
            if player.current_bet != self.current_bet:
                return False

    return True
```

---

## ì°¸ê³  ìë£Œ

### ê´€ë ¨ íŒŒì¼
- `src/core/game.py` - ê²Œì„ í˜ì´ì¦ˆ ë° ë² íŒ… ë¼ìš´ë“œ êµ¬í˜„
- `src/core/player.py` - í”Œë ˆì´ì–´ ìƒíƒœ ê´€ë¦¬
- `docs/ê²Œì„ê·œì¹™.md` - ê²Œì„ ê·œì¹™ ìƒì„¸ ì„¤ëª…
- `docs/ê²Œì„í”Œë¡œìš°.md` - ì „ì²´ ê²Œì„ íë¦„

### ìƒíƒœ ê´€ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] GamePhase Enum ì •ì˜ ì™„ë£Œ
- [ ] ê²Œì„ í˜ì´ì¦ˆ ì „ì´ ë¡œì§ êµ¬í˜„
- [ ] í”Œë ˆì´ì–´ ìƒíƒœ ê´€ë¦¬ ë©”ì„œë“œ êµ¬í˜„
- [ ] ë² íŒ… ë¼ìš´ë“œ ì¢…ë£Œ ì¡°ê±´ êµ¬í˜„
- [ ] ì¡°ê¸° ì¢…ë£Œ ì²˜ë¦¬ êµ¬í˜„
- [ ] ìƒíƒœë³„ í—ˆìš© ì•¡ì…˜ ê²€ì¦ ë¡œì§

---

**ë¬¸ì„œ ë²„ì „**: 1.0
**ìµœì¢… ìˆ˜ì •**: 2025-10-01
